(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{4970:(e,t,l)=>{"use strict";l.d(t,{P3:()=>h,Rn:()=>i,c5:()=>o,dA:()=>c,r9:()=>r,tm:()=>u,uP:()=>a,vo:()=>d});var n=l(7026),s=l(518);function r(){return(0,n.A)({endpoint:s.b.races.create,method:"POST",invalidateKeys:[{queryKey:["races"]}]})}function a(e){return(0,n.A)({endpoint:s.b.races.listRaces(e),method:"GET",queryKey:["races"]})}function c(e){return(0,n.A)({endpoint:s.b.races.listRace(e),method:"GET",queryKey:["race",e]})}function i(e){return(0,n.A)({endpoint:s.b.races.listRaceItems(e),method:"GET",queryKey:["raceItems",e]})}function o(e){return(0,n.A)({endpoint:s.b.races.loftBasketing(e),method:"PATCH",invalidateKeys:[{queryKey:["raceItems"]}]})}function u(e){return(0,n.A)({endpoint:s.b.races.raceBasketing(e),method:"PATCH",invalidateKeys:[{queryKey:["raceItems"]}]})}function d(e){return(0,n.A)({endpoint:s.b.races.publishResult(e),method:"POST",invalidateKeys:[{queryKey:["raceResults",e]}]})}function h(e){return(0,n.A)({endpoint:s.b.races.listResults(e),method:"GET",queryKey:["raceResults",e]})}},8874:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>q});var n=l(8260),s=l(2297),r=l(3657),a=l(4091),c=l(4105),i=l(9707),o=l(1839),u=l(1912),d=l(3941),h=l(7688),x=l(9832),m=l(8320),f=l(2570),j=l(772),p=l(7814);function v(e){let{className:t,children:l,...s}=e;return(0,n.jsxs)(j.bL,{"data-slot":"scroll-area",className:(0,p.cn)("relative",t),...s,children:[(0,n.jsx)(j.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:l}),(0,n.jsx)(g,{}),(0,n.jsx)(j.OK,{})]})}function g(e){let{className:t,orientation:l="vertical",...s}=e;return(0,n.jsx)(j.VM,{"data-slot":"scroll-area-scrollbar",orientation:l,className:(0,p.cn)("flex touch-none p-px transition-colors select-none","vertical"===l&&"h-full w-2.5 border-l border-l-transparent","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent",t),...s,children:(0,n.jsx)(j.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}let b=["en-US","en-CA","en-AU","en-NZ","en-PH","en-IN","en-IE","en-GB","en-ZA","en-NG","en-MY","en-BD","en-PK","es-US","es-MX","es-CO","es-PH","ar-SA","ar-EG"],y=["en","de","fr","ja","pt","nl","zh","ru","es","uk"],N=(e,t)=>e instanceof Date?e:x[y.includes(t.code)?t.code:y.includes(t.code.split("-")[0])?t.code.split("-")[0]:"en"].parseDate(e),I=(e,t,l)=>new Date(e).toLocaleTimeString(t.code,{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:l}),A="bg-transparent focus:outline-none focus:ring-0 focus-within:outline-none focus-within:ring-0 sm:text-sm disabled:cursor-not-allowed disabled:opacity-50",C=h.createContext(null),w=()=>{let e=h.useContext(C);if(!e)throw Error("useSmartDateInput must be used within SmartDateInputProvider");return e},T=h.forwardRef((e,t)=>{let{className:l,value:s,locale:r=m.c,hour12:a=b.includes(r.code),onValueChange:c,placeholder:i,disabled:o,...u}=e,[d,x]=h.useState(""),f=h.useCallback(e=>{x(e)},[]),j={...m.c,...r,code:(null==r?void 0:r.code)||m.c.code};return(0,n.jsx)(C.Provider,{value:{value:s,onValueChange:c,Time:d,onTimeChange:f},children:(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsxs)("div",{className:(0,p.cn)("flex gap-1 w-full p-1 items-center justify-between rounded-md border transition-all","focus-within:outline-0 focus:outline-0 focus:ring-0","placeholder:text-muted-foreground focus-visible:outline-0 ",l),children:[(0,n.jsx)(P,{locale:j,hour12:a,disabled:o,...u}),(0,n.jsx)(M,{ref:t,locale:j,hour12:a,placeholder:i,disabled:"boolean"==typeof o?o:void 0})]})})})});T.displayName="DatetimeInput";let E=e=>{let{hour12:t,locale:l}=e,{value:s,onValueChange:a,Time:c,onTimeChange:i}=w(),[o,u]=h.useState(-1),d=h.useCallback((e,t,n)=>{i(e);let r=N(null!=s?s:new Date,l);r&&(r.setHours(t,0===n?parseInt("00"):15*n),a(r))},[l,s,a,i]),x=h.useCallback(e=>{if(e.stopPropagation(),document)switch(e.key){case"ArrowUp":(()=>{let e=o-1<0?95:o-1,t=document.getElementById("time-".concat(e));null==t||t.focus(),u(e)})();break;case"ArrowDown":(()=>{let e=o+1>95?0:o+1,t=document.getElementById("time-".concat(e));null==t||t.focus(),u(e)})();break;case"Escape":(()=>{let e=document.getElementById("time-".concat(o));null==e||e.blur(),u(-1)})();break;case"Enter":(()=>{var e;let l=document.getElementById("time-".concat(o));if(!l)return;l.focus();let n=null!=(e=l.textContent)?e:"",s=parseInt(n.split(":")[0]),r=parseInt(n.split(":")[1].split(" ")[0]);t&&(s="AM"===n.split(" ")[1]?12===s?0:s:12===s?12:s+12),d(n,s,Math.floor(r/15))})()}},[o,d,t]),m=h.useCallback((e,l,n,s)=>{let r=e;t&&e>12&&(r=e%12);let a=0===r?12:r;d(t?"".concat(a,":").concat(0===l?"00":15*l," ").concat(n):"".concat(e,":").concat(0===l?"00":15*l),e,l),u(s)},[d,t]),f=h.useMemo(()=>{let e=c.split(" ")[0];return{hours:parseInt(e.split(":")[0]),minutes:parseInt(e.split(":")[1])}},[c]);h.useEffect(()=>{(()=>{let e=c.split(" ")[0],l=parseInt(e.split(":")[0]),n=parseInt(e.split(":")[1]),s=t?c.split(" ")[1]:"",r=t?"AM"===s||12===l?l:l+12:l;for(let e=0;e<=3;e++){let l=Math.abs(15*e-n);if(!t||s===(r>=12?"PM":"AM")&&(n<=53?l<Math.ceil(7.5):l<15)){let t=-1===o?4*r+e:o;u(t);let l=document.getElementById("time-".concat(t));null==l||l.scrollIntoView({block:"center",behavior:"smooth"})}}})()},[c,o,t]);let j=h.useMemo(()=>{if(!document)return;let e=document.getElementById("calendar");if(e)return e.style.height},[]);return(0,n.jsx)("div",{className:"space-y-2 pr-3 py-3 relative ",children:(0,n.jsx)(v,{onKeyDown:x,className:"h-full w-full focus-visible:outline-0 focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:border-0 py-0.5",style:{height:j},children:(0,n.jsx)("ul",{className:(0,p.cn)("flex items-center flex-col gap-1 h-full max-h-56 w-28 px-1 py-0.5"),children:Array.from({length:24}).map((e,l)=>{let a=l>=12?"PM":"AM",i=l>12?l%12:0===l||12===l?12:l;return Array.from({length:4}).map((e,o)=>{let d=Math.abs(15*o-f.minutes),h=4*l+o,x=(f.hours===l||f.hours===i)&&(!t||c.split(" ")[1]===a)&&(f.minutes<=53?d<Math.ceil(7.5):d<15),j=!s&&x,v=t?"".concat(i,":").concat(0===o?"00":15*o," ").concat(a):"".concat(l,":").concat(0===o?"00":15*o);return(0,n.jsx)("li",{tabIndex:x?0:-1,id:"time-".concat(h),"aria-label":"currentTime",className:(0,p.cn)((0,r.r)({variant:j?"secondary":x?"default":"outline"}),"h-8 px-3 w-full text-sm focus-visible:outline-0 outline-0 focus-visible:border-0 cursor-default ring-0"),onClick:()=>m(l,o,a,h),onFocus:()=>j&&u(h),children:v},"time-".concat(h))})})})})})},M=h.forwardRef((e,t)=>{let{locale:l,hour12:s,placeholder:r,...a}=e,{value:c,onValueChange:i,Time:u,onTimeChange:d}=w(),x=null!=r?r:"fr"===l.code.split("-")[0]?'e.g. "demain \xe0 17h" ou "dans 2 heures"':'e.g. "tomorrow at 5pm" or "in 2 hours"',[m,f]=h.useState("");h.useEffect(()=>{let e=new Date().getHours(),t=s?"".concat(e>=12?e%12:e,":").concat(new Date().getMinutes()," ").concat(e>=12?"PM":"AM"):"".concat(e,":").concat(new Date().getMinutes());f(c?I(c,l,s):""),d(c?u:t)},[s,l,c,u,d]);let j=h.useCallback(e=>{if(""===e.currentTarget.value){d(""),i(null);return}let t=N(e.currentTarget.value,l);if(t)if(s){let e=t.getHours()>=12?"PM":"AM",n=t.getHours();i(t),f(I(t,l,s)),d("".concat(n>12?n%12:0===n||12===n?12:n,":").concat(t.getMinutes()," ").concat(e))}else i(t),f(I(t,l,s)),d("".concat(t.getHours(),":").concat(t.getMinutes()))},[l,s,i,d]),v=h.useCallback(e=>{if("Enter"===e.key){let t=N(e.currentTarget.value,l);if(t){let e=t.getHours()>=12?"PM":"AM",n=t.getHours();i(t),f(I(t,l,s)),d("".concat(n>12?n%12:0===n||12===n?12:n,":").concat(t.getMinutes()," ").concat(e))}}},[l,s,i,d]);return(0,n.jsx)(o.p,{ref:t,type:"text",placeholder:x,value:m,onChange:e=>{f(e.target.value)},onKeyDown:v,onBlur:j,className:(0,p.cn)("px-2 mr-0.5 flex-1 border-none h-8 rounded",A),...a})});M.displayName="NaturalLanguageInput";let P=e=>{let{locale:t,hour12:l,className:s,...c}=e,{value:i,onValueChange:o,Time:d}=w(),x=h.useCallback((e,l,n,s)=>{let r=N(l,t);r&&(r.setHours(parseInt(d.split(":")[0]),parseInt(d.split(":")[1])),o(r))},[t,d,o]);return(0,n.jsxs)(u.AM,{children:[(0,n.jsx)(u.Wv,{asChild:!0,children:(0,n.jsxs)(r.$,{variant:"outline",size:"icon",className:(0,p.cn)("size-9 flex items-center justify-center font-normal",!i&&"text-muted-foreground"),children:[(0,n.jsx)(f.A,{className:"size-4"}),(0,n.jsx)("span",{className:"sr-only",children:"calender"})]})}),(0,n.jsx)(u.hl,{className:"w-auto p-0",sideOffset:8,children:(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(a.V,{...c,locale:t,id:"calendar",className:(0,p.cn)("peer flex justify-end",A,s),mode:"single",selected:null!=i?i:void 0,onSelect:x,initialFocus:!0}),(0,n.jsx)(E,{locale:t,hour12:l})]})})]})};P.displayName="DateTimeLocalInput";var R=l(4970),S=l(8648),k=l(1328),D=l(6320),O=l(8447),H=l(647),L=l(4046);let _=L.Ay$.object({eventId:L.Ay$.uuid(),type:L.Ay$.enum(["TRAINING","INVENTORY","LOFT_FLY","PULLING_FLIGHT","FINAL_RACE","HOTSPOT_1","HOTSPOT_2","HOTSPOT_3","AVG_WINNER"]),location:L.Ay$.string().min(1,"Location is required"),startTime:L.Ay$.date(),distance:L.Ay$.string().min(1,"Distance is required"),arrivalDate:L.Ay$.date()});function V(e){let{events:t,selectedEventId:l}=e,[s,x]=(0,h.useState)(!1),{mutateAsync:m}=(0,R.r9)(),j=(0,O.mN)({resolver:(0,S.u)(_),defaultValues:{eventId:l||"",type:"TRAINING",location:"",distance:"",startTime:new Date,arrivalDate:new Date}}),v=async e=>{if(m)try{let{data:t,error:l}=await m(e);if(l)return void H.o.error("Failed to create race");H.o.success("Race created successfully"),x(!1),j.reset()}catch(e){console.error("Error creating race:",e),H.o.error("An error occurred while creating the race")}};return(0,n.jsxs)(c.lG,{open:s,onOpenChange:x,children:[(0,n.jsx)(c.zM,{asChild:!0,children:(0,n.jsxs)(r.$,{children:[(0,n.jsx)(D.A,{className:"mr-2 h-4 w-4"}),"Create Race"]})}),(0,n.jsxs)(c.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)(c.c7,{children:[(0,n.jsx)(c.L3,{children:"Create New Race"}),(0,n.jsx)(c.rr,{children:"Fill in the details to create a new race for your selected event."})]}),(0,n.jsx)(i.lV,{...j,children:(0,n.jsxs)("form",{onSubmit:j.handleSubmit(v),className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,n.jsx)(i.zB,{control:j.control,name:"eventId",render:e=>{let{field:l}=e;return(0,n.jsxs)(i.eI,{children:[(0,n.jsx)(i.lR,{children:"Event"}),(0,n.jsxs)(d.l6,{onValueChange:l.onChange,defaultValue:l.value,children:[(0,n.jsx)(i.MJ,{children:(0,n.jsx)(d.bq,{className:"w-full",children:(0,n.jsx)(d.yv,{placeholder:"Select Event"})})}),(0,n.jsx)(d.gC,{children:t.map(e=>(0,n.jsx)(d.eb,{value:e.id,children:e.name},e.id))})]}),(0,n.jsx)(i.C5,{})]})}}),(0,n.jsx)(i.zB,{control:j.control,name:"type",render:e=>{let{field:t}=e;return(0,n.jsxs)(i.eI,{children:[(0,n.jsx)(i.lR,{children:"Type"}),(0,n.jsxs)(d.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,n.jsx)(i.MJ,{children:(0,n.jsx)(d.bq,{className:"w-full",children:(0,n.jsx)(d.yv,{placeholder:"Select Type"})})}),(0,n.jsxs)(d.gC,{children:[(0,n.jsx)(d.eb,{value:"TRAINING",children:"Training"}),(0,n.jsx)(d.eb,{value:"INVENTORY",children:"Inventory"}),(0,n.jsx)(d.eb,{value:"LOFT_FLY",children:"Loft Fly"}),(0,n.jsx)(d.eb,{value:"PULLING_FLIGHT",children:"Pulling Flight"}),(0,n.jsx)(d.eb,{value:"FINAL_RACE",children:"Final Race"}),(0,n.jsx)(d.eb,{value:"HOTSPOT_1",children:"Hotspot 1"}),(0,n.jsx)(d.eb,{value:"HOTSPOT_2",children:"Hotspot 2"}),(0,n.jsx)(d.eb,{value:"HOTSPOT_3",children:"Hotspot 3"}),(0,n.jsx)(d.eb,{value:"AVG_WINNER",children:"Average Winner"})]})]}),(0,n.jsx)(i.C5,{})]})}}),(0,n.jsx)(i.zB,{control:j.control,name:"distance",render:e=>{let{field:t}=e;return(0,n.jsxs)(i.eI,{children:[(0,n.jsx)(i.lR,{children:"Distance (miles)"}),(0,n.jsx)(i.MJ,{children:(0,n.jsx)(o.p,{placeholder:"Enter distance",type:"text",...t})}),(0,n.jsx)(i.C5,{})]})}})]}),(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,n.jsx)(i.zB,{control:j.control,name:"location",render:e=>{let{field:t}=e;return(0,n.jsxs)(i.eI,{children:[(0,n.jsx)(i.lR,{children:"Liberation"}),(0,n.jsx)(i.MJ,{children:(0,n.jsx)(o.p,{placeholder:"Enter liberation location",type:"text",...t})}),(0,n.jsx)(i.C5,{})]})}}),(0,n.jsx)(i.zB,{control:j.control,name:"startTime",render:e=>{let{field:t}=e;return(0,n.jsxs)(i.eI,{className:"flex flex-col",children:[(0,n.jsx)(i.lR,{children:"Start Date"}),(0,n.jsx)(i.MJ,{children:(0,n.jsx)(T,{value:t.value,onValueChange:t.onChange,placeholder:"Select start date and time"})}),(0,n.jsx)(i.C5,{})]})}}),(0,n.jsx)(i.zB,{control:j.control,name:"arrivalDate",render:e=>{let{field:t}=e;return(0,n.jsxs)(i.eI,{className:"flex flex-col",children:[(0,n.jsx)(i.lR,{children:"Arrival Date"}),(0,n.jsxs)(u.AM,{children:[(0,n.jsx)(u.Wv,{asChild:!0,children:(0,n.jsx)(i.MJ,{children:(0,n.jsxs)(r.$,{variant:"outline",className:(0,p.cn)("w-full pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),children:[t.value?(0,k.GP)(t.value,"PPP"):(0,n.jsx)("span",{children:"Pick a date"}),(0,n.jsx)(f.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,n.jsx)(u.hl,{className:"w-auto p-0",align:"start",children:(0,n.jsx)(a.V,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0})})]}),(0,n.jsx)(i.C5,{})]})}})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,n.jsx)(r.$,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Cancel"}),(0,n.jsx)(r.$,{type:"submit",children:"Create Race"})]})]})})]})]})}var F=l(6462),G=l(3589),B=l(9681),K=l(8742);function q(){let[e,t]=(0,K.ZA)("eventId",{defaultValue:""}),{data:l,error:s,isError:r,isPending:a}=(0,B.NC)();if(a)return(0,n.jsx)("div",{children:"Loading..."});if(r)return(0,n.jsxs)("div",{children:["Error: ",s.message]});if(!l||0===l.length)return(0,n.jsx)("div",{children:"No events found."});let c=l.data.events||[];return(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)(z,{events:c}),(0,n.jsx)(V,{events:c,selectedEventId:e})]}),(0,n.jsx)("div",{className:"mt-4",children:e?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)($,{})}):(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Select an Event"})})]})}function z(e){let{events:t}=e,[l,s]=(0,K.ZA)("eventId",{defaultValue:""});return(0,n.jsxs)("div",{children:[(0,n.jsx)(G.J,{htmlFor:"event-select",children:"Select an Event"}),(0,n.jsxs)(d.l6,{onValueChange:e=>{"all"===e?s(""):s(e)},value:l,children:[(0,n.jsx)(d.bq,{className:"w-[300px] mt-2",id:"event-select",children:(0,n.jsx)(d.yv,{placeholder:"Select an event"})}),(0,n.jsxs)(d.gC,{children:[(0,n.jsx)(d.eb,{value:"all",onClick:()=>s(""),children:"All Events"}),t.map(e=>(0,n.jsxs)(d.eb,{value:e.id,onClick:()=>s(e.id),children:[e.name," (",e.shortName,")"]},e.id))]})]})]})}function $(){let[e,t]=(0,K.ZA)("eventId",{defaultValue:""}),{data:l,error:r,isError:a,isPending:c}=(0,R.uP)(e);if(c)return(0,n.jsx)("div",{children:"Loading..."});if(a)return(0,n.jsxs)("div",{children:["Error: ",r.message]});let i=null==l?void 0:l.data;return(0,n.jsx)(F.b,{columns:s.Rn,data:i})}},9260:(e,t,l)=>{Promise.resolve().then(l.bind(l,8874))}},e=>{e.O(0,[29,974,641,736,633,84,882,361,46,695,412,433,561,742,358],()=>e(e.s=9260)),_N_E=e.O()}]);