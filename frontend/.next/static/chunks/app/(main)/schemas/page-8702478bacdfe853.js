(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[260],{1342:(e,r,s)=>{Promise.resolve().then(s.bind(s,7545))},7545:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>S});var n=s(8260),t=s(4105),i=s(8447),a=s(8648),l=s(5071),c=s(3657),o=s(9707),d=s(1839),m=s(1362),u=s(4387),x=s(647);let h=l.Ik({name:l.Yj().min(1,"Name is required"),entryFee:l.ai().min(0,"Entry fee must be a positive number"),expensePercentage:l.ai().min(0,"Percent for expenses must be a positive number").max(100,"Percent for expenses cannot exceed 100"),minEntryFee:l.ai().min(0,"Min entry fee must be a positive number"),entryFeeRefundable:l.zM(),hs1Fee:l.ai().min(0,"HS1 fee must be a positive number"),hs2Fee:l.ai().min(0,"HS2 fee must be a positive number"),hs3Fee:l.ai().min(0,"HS3 fee must be a positive number"),finalRaceFee:l.ai().min(0,"Final race fee must be a positive number"),maxBirds:l.ai().min(1,"Limit of main birds per team must be at least 1"),maxBackupBirds:l.ai().min(0,"Limit of backup birds per team must be a positive number"),floatingBackup:l.zM()}),j=l.Ik({name:l.Yj().min(1,"Name is required"),distributions:l.YO(l.Ik({fromPosition:l.ai().int().min(1,"From position must be at least 1"),toPosition:l.ai().int().min(1,"To position must be at least 1"),percentage:l.ai().min(0,"Percentage must be a non-negative number").max(100,"Percentage cannot exceed 100")}))});function p(e){let{type:r,action:s,id:i}=e;return(console.log("SchemaForm rendered with type:",r,"action:",s,"id:",i),"fee"===r&&"create"===s)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.L3,{children:"Create Fee"}),(0,n.jsx)(y,{action:"create"})]}):"fee"===r&&"update"===s&&i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.L3,{children:"Update Fee"}),(0,n.jsx)(b,{id:i})]}):"prize"===r&&"update"===s&&i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.L3,{children:"Update Prize"}),(0,n.jsx)(f,{id:i})]}):"prize"===r&&"create"===s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.L3,{children:"Create Prize"}),(0,n.jsx)(g,{action:"create"})]}):void 0}function b(e){let{id:r}=e,{data:s,isPending:t,error:i,isError:a,isSuccess:l}=(0,u._A)(r),c=null==s?void 0:s.data;return t?(0,n.jsx)("p",{children:"Loading..."}):a?(0,n.jsxs)("p",{children:["Error: ",i.message]}):(0,n.jsx)(y,{action:"update",id:r,defaultValues:c})}function f(e){let{id:r}=e,{data:s,isPending:t,error:i,isError:a,isSuccess:l}=(0,u.eQ)(r),c=null==s?void 0:s.data;return t?(0,n.jsx)("p",{children:"Loading..."}):a?(0,n.jsxs)("p",{children:["Error: ",i.message]}):(0,n.jsx)(g,{action:"update",id:r,defaultValues:c})}function g(e){let{action:r,id:s,defaultValues:t}=e,{mutateAsync:l}=(0,u.ec)(),{mutateAsync:m}=(0,u.FT)(s||""),h=(0,i.mN)({resolver:(0,a.u)(j),defaultValues:t||{name:"",distributions:[]}}),{fields:p,append:b,remove:f}=(0,i.jz)({name:"distributions",control:h.control});async function g(e){try{if("create"===r){if(!l)return;let{data:r,error:s,status:n}=await l(e);if(s)return void x.o.error(s);x.o.success("Prize created successfully!"),h.reset()}else if("update"===r&&s){if(!m)return;let{data:r,error:s,status:n}=await m(e);if(s)return void x.o.error(s);x.o.success("Prize updated successfully!")}}catch(e){console.error("Form submission error",e),x.o.error("Failed to submit the form. Please try again.")}}return(0,n.jsx)(o.lV,{...h,children:(0,n.jsxs)("form",{onSubmit:h.handleSubmit(g),className:"space-y-4 max-w-5xl w-full mx-auto",children:[(0,n.jsx)(o.zB,{control:h.control,name:"name",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Name"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"text",...r,disabled:h.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),p.map((e,r)=>(0,n.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,n.jsx)(o.zB,{control:h.control,name:"distributions.".concat(r,".fromPosition"),render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"From Position"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:h.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:h.control,name:"distributions.".concat(r,".toPosition"),render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"To Position"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:h.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:h.control,name:"distributions.".concat(r,".percentage"),render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"Percentage"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:h.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(c.$,{className:"mt-5",type:"button",variant:"destructive",onClick:()=>f(r),disabled:h.formState.isSubmitting,children:"Remove"})]},e.id)),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(c.$,{type:"button",onClick:()=>b({fromPosition:1,toPosition:1,percentage:0}),disabled:h.formState.isSubmitting,children:"Add Distribution"}),(0,n.jsx)(c.$,{type:"submit",disabled:h.formState.isSubmitting,children:"create"===r?"Create Prize":"Update Prize"})]})]})})}function y(e){let{action:r,id:s,defaultValues:t}=e,{mutateAsync:l}=(0,u._I)(),{mutateAsync:j}=(0,u.Jr)(s||""),p=(0,i.mN)({resolver:(0,a.u)(h),defaultValues:t||{name:"",entryFee:0,expensePercentage:0,minEntryFee:0,entryFeeRefundable:!1,hs1Fee:0,hs2Fee:0,hs3Fee:0,finalRaceFee:0,maxBirds:1,maxBackupBirds:0,floatingBackup:!1}});async function b(e){try{if("create"===r){if(!l)return;let{data:r,error:s,status:n}=await l(e);if(s)return void x.o.error(s);x.o.success("Fee created successfully!"),p.reset()}else if("update"===r&&s){if(!j)return;let{data:r,error:s,status:n}=await j(e);if(s)return void x.o.error(s);x.o.success("Fee updated successfully!")}}catch(e){console.error("Form submission error",e),x.o.error("Failed to submit the form. Please try again.")}}return(0,n.jsx)(o.lV,{...p,children:(0,n.jsxs)("form",{onSubmit:p.handleSubmit(b),className:"space-y-4 max-w-5xl w-full mx-auto",children:[(0,n.jsx)(o.zB,{control:p.control,name:"name",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Name"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"text",...r,disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)(o.zB,{control:p.control,name:"entryFee",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"Entry Fee"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:p.control,name:"expensePercentage",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"Percent for expenses"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}})]}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)(o.zB,{control:p.control,name:"minEntryFee",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"Min entry fees per team"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:p.control,name:"entryFeeRefundable",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"flex flex-row space-x-3 w-full space-y-0 p-2 self-end",children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.S,{className:"border-black",checked:r.value,onCheckedChange:r.onChange,disabled:p.formState.isSubmitting})}),(0,n.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,n.jsx)(o.lR,{children:"Allow entry fee refund when bird is lost"}),(0,n.jsx)(o.C5,{})]})]})}})]}),(0,n.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,n.jsx)(o.zB,{control:p.control,name:"hs1Fee",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"HS1"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:p.control,name:"hs2Fee",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"HS 2"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:p.control,name:"hs3Fee",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"HS 3"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:p.control,name:"finalRaceFee",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Final Race"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}})]}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)(o.zB,{control:p.control,name:"maxBirds",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"Limit of main birds per team"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:p.control,name:"maxBackupBirds",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"w-full",children:[(0,n.jsx)(o.lR,{children:"Limit of backup birds per team"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(d.p,{placeholder:"",type:"number",...r,onChange:e=>r.onChange(Number(e.target.value)),disabled:p.formState.isSubmitting})}),(0,n.jsx)(o.C5,{})]})}})]}),(0,n.jsx)(o.zB,{control:p.control,name:"floatingBackup",render:e=>{let{field:r}=e;return(0,n.jsxs)(o.eI,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.S,{checked:r.value,onCheckedChange:r.onChange,disabled:p.formState.isSubmitting})}),(0,n.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,n.jsx)(o.lR,{children:"Floating Backup"}),(0,n.jsx)(o.C5,{})]})]})}}),(0,n.jsx)(c.$,{type:"submit",disabled:p.formState.isSubmitting,children:"create"===r?"Create Fee":"Update Fee"})]})})}function C(e){let{schema:r,type:s}=e;return(0,n.jsxs)(t.lG,{children:[(0,n.jsx)(t.zM,{asChild:!0,children:(0,n.jsx)("div",{className:"p-4 border rounded mb-4 hover:bg-primary/10",children:(0,n.jsx)("h2",{className:"text-xl font-semibold",children:r.name})})}),(0,n.jsx)(t.Cf,{className:"max-w-5xl w-full",children:(0,n.jsx)(p,{type:s,action:"update",id:r.id})})]})}function S(){let{data:e,isPending:r,isSuccess:s,isError:i,error:a}=(0,u.xU)({params:{}}),{data:l,isPending:o,isSuccess:d,isError:m,error:x}=(0,u.Xp)({params:{}}),h=(null==e?void 0:e.data)||[],j=(null==l?void 0:l.data)||[];return(0,n.jsxs)("div",{className:"flex h-screen",children:[(0,n.jsxs)("div",{className:"w-1/2 p-4 border-r",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Fee Schema"}),(0,n.jsxs)(t.lG,{children:[(0,n.jsx)(t.zM,{asChild:!0,children:(0,n.jsx)(c.$,{children:"Create Fee Scheme"})}),(0,n.jsx)(t.Cf,{className:"max-w-5xl w-full",children:(0,n.jsx)(p,{type:"fee",action:"create"})})]})]}),o&&(0,n.jsx)("p",{children:"Loading fees..."}),m&&(0,n.jsxs)("p",{children:["Error loading fees: ",x.message]}),d&&0===j.length&&(0,n.jsx)("p",{children:"No fee schemas available."}),d&&j.map(e=>(0,n.jsx)(C,{schema:e,type:"fee"},e.id))]}),(0,n.jsxs)("div",{className:"w-1/2 p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Prize Schema"}),(0,n.jsxs)(t.lG,{children:[(0,n.jsx)(t.zM,{asChild:!0,children:(0,n.jsx)(c.$,{children:"Create Prize Scheme"})}),(0,n.jsx)(t.Cf,{className:"max-w-5xl w-full",children:(0,n.jsx)(p,{type:"prize",action:"create"})})]})]}),r&&(0,n.jsx)("p",{children:"Loading prizes..."}),i&&(0,n.jsxs)("p",{children:["Error loading prizes: ",a.message]}),s&&0===h.length&&(0,n.jsx)("p",{children:"No prize schemas available."}),s&&h.map(e=>(0,n.jsx)(C,{schema:e,type:"prize"},e.id))]})]})}s(7688)}},e=>{e.O(0,[29,974,641,736,84,412,561,742,358],()=>e(e.s=1342)),_N_E=e.O()}]);